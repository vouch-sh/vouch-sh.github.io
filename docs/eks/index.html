<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Authenticate to Amazon EKS without Static Credentials â€” Vouch â€” Hardware-Backed Developer Credentials</title>
<meta name=description content="Access EKS clusters using OIDC-federated IAM credentials instead of long-lived kubeconfig tokens."><link rel=canonical href=https://vouch.sh/docs/eks/><meta property="og:title" content="Authenticate to Amazon EKS without Static Credentials â€” Vouch â€” Hardware-Backed Developer Credentials"><meta property="og:description" content="Access EKS clusters using OIDC-federated IAM credentials instead of long-lived kubeconfig tokens."><meta property="og:url" content="https://vouch.sh/docs/eks/"><meta property="og:site_name" content="Vouch"><meta property="og:type" content="article"><meta property="og:image" content="https://vouch.sh/img/og-image.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Authenticate to Amazon EKS without Static Credentials â€” Vouch â€” Hardware-Backed Developer Credentials"><meta name=twitter:description content="Access EKS clusters using OIDC-federated IAM credentials instead of long-lived kubeconfig tokens."><meta name=twitter:image content="https://vouch.sh/img/og-image.png"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"><link rel=icon href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ”‘</text></svg>"><link rel=author href=/humans.txt><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","description":"Open-source credential broker that issues short-lived SSH, AWS, GitHub, and Kubernetes credentials after FIDO2 hardware verification. One YubiKey tap, 8 hours of access.","name":"Vouch","url":"https://vouch.sh/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","logo":"https://vouch.sh/img/og-image.png","name":"Smoke Turner, LLC","sameAs":["https://github.com/vouch-sh/vouch"],"url":"https://smoketurner.com"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"TechArticle","author":{"@type":"Organization","name":"Smoke Turner, LLC"},"description":"Access EKS clusters using OIDC-federated IAM credentials instead of long-lived kubeconfig tokens.","headline":"Authenticate to Amazon EKS without Static Credentials","mainEntityOfPage":{"@id":"https://vouch.sh/docs/eks/","@type":"WebPage"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://vouch.sh/img/og-image.png"},"name":"Smoke Turner, LLC"}}</script><link rel=stylesheet href=https://vouch.sh/css/main.min.696319dec26a9f9526ac8dae8c8e12c4271af4250b998632e1aca67447bb363d.css></head><body><header class=nav><div class=nav-inner><a href=/ class=nav-logo><svg viewBox="0 0 32 32" fill="none"><rect x="9" y="14" width="14" height="12" rx="2" stroke="currentcolor" stroke-width="2"/><path d="M12 14V10a4 4 0 118 0v4" stroke="currentcolor" stroke-width="2" stroke-linecap="round"/><circle cx="16" cy="20" r="1.5" fill="currentcolor"/><line x1="16" y1="21.5" x2="16" y2="23.5" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"/></svg>
vouch
</a><button class=nav-toggle aria-label="Toggle navigation" onclick='document.querySelector(".nav-links").classList.toggle("open")'><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class=nav-links><li><a href=/docs/>Docs</a></li><li><a href=/blog/>Blog</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/vouch-sh/vouch target=_blank rel=noopener>GitHub<svg class="github-icon" viewBox="0 0 24 24" fill="currentcolor"><path d="M12 0C5.37.0.0 5.37.0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57.0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925.0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18.0.0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225.0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22.0 1.605-.015 2.895-.015 3.3.0.315.225.69.825.57A12.02 12.02.0 0024 12c0-6.63-5.37-12-12-12z"/></svg></a></li></ul></div></header><main class=content-wrapper><div class=docs-layout><aside class=docs-sidebar id=docs-sidebar><div class=docs-sidebar-title>Documentation</div><nav><ul><li><a href=https://vouch.sh/docs/getting-started/>Getting Started</a></li><li><a href=https://vouch.sh/docs/startups/>Startups</a></li><li class=sidebar-section-group><span class=sidebar-section-label>Infrastructure</span><ul><li><a href=https://vouch.sh/docs/aws/>AWS</a></li><li><a href=https://vouch.sh/docs/aws-multi-account/>AWS Multi-Account</a></li><li><a href=https://vouch.sh/docs/ssh/>SSH Certificates</a></li><li><a href=https://vouch.sh/docs/eks/ class=active>Amazon EKS</a></li><li><a href=https://vouch.sh/docs/ssm/>AWS Systems Manager</a></li><li><a href=https://vouch.sh/docs/databases/>Databases</a></li><li><a href=https://vouch.sh/docs/bedrock/>Amazon Bedrock</a></li></ul></li><li class=sidebar-section-group><span class=sidebar-section-label>Code & Packages</span><ul><li><a href=https://vouch.sh/docs/github/>GitHub</a></li><li><a href=https://vouch.sh/docs/docker/>Docker Registries</a></li><li><a href=https://vouch.sh/docs/codeartifact/>AWS CodeArtifact</a></li><li><a href=https://vouch.sh/docs/codecommit/>AWS CodeCommit</a></li><li><a href=https://vouch.sh/docs/cargo/>Cargo</a></li></ul></li><li class=sidebar-section-group><span class=sidebar-section-label>Platform</span><ul><li class=sidebar-group><div class=sidebar-group-header><a href=https://vouch.sh/docs/applications/>Applications (OIDC)
</a><button class=sidebar-chevron onclick='this.closest(".sidebar-group").classList.toggle("open")' aria-label="Toggle section"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg></button></div><ul class=sidebar-children><li><a href=https://vouch.sh/docs/applications/rails/>Rails (OmniAuth)</a></li><li><a href=https://vouch.sh/docs/applications/django/>Django (django-allauth)</a></li><li><a href=https://vouch.sh/docs/applications/express/>Express.js (Passport)</a></li><li><a href=https://vouch.sh/docs/applications/nextjs/>Next.js (NextAuth.js)</a></li><li><a href=https://vouch.sh/docs/applications/laravel/>Laravel (Socialite)</a></li><li><a href=https://vouch.sh/docs/applications/flask/>Flask (Authlib)</a></li><li><a href=https://vouch.sh/docs/applications/fastapi/>FastAPI (Authlib)</a></li><li><a href=https://vouch.sh/docs/applications/spring-boot/>Spring Boot (Spring Security)</a></li><li><a href=https://vouch.sh/docs/applications/axum/>Axum (openidconnect-rs)</a></li><li><a href=https://vouch.sh/docs/applications/react/>React (react-oidc-context)</a></li><li><a href=https://vouch.sh/docs/applications/vue/>Vue (oidc-client-ts)</a></li><li><a href=https://vouch.sh/docs/applications/vanilla-js/>Vanilla JavaScript</a></li><li><a href=https://vouch.sh/docs/applications/device-authorization/>Device Authorization (CLI)</a></li></ul></li><li><a href=https://vouch.sh/docs/scim/>SCIM Provisioning</a></li><li><a href=https://vouch.sh/docs/iac/>Infrastructure as Code</a></li><li><a href=https://vouch.sh/docs/cicd/>CI/CD</a></li><li><a href=https://vouch.sh/docs/cli-reference/>CLI Reference</a></li><li><a href=https://vouch.sh/docs/security/>Security</a></li><li><a href=https://vouch.sh/docs/threat-model/>Threat Model</a></li><li><a href=https://vouch.sh/docs/architecture/>Architecture</a></li><li><a href=https://vouch.sh/docs/availability/>Availability</a></li><li><a href=https://vouch.sh/docs/migration/>Migration</a></li><li><a href=https://vouch.sh/docs/faq/>FAQ</a></li></ul></li></ul></nav></aside><article class=docs-content><div class=docs-breadcrumb><a href=https://vouch.sh/docs/>Docs</a><span class=separator>/</span>
Authenticate to Amazon EKS without Static Credentials</div><h1>Authenticate to Amazon EKS without Static Credentials</h1><p style=color:var(--text-muted);font-size:1.1rem;margin-bottom:2rem>Authenticate to EKS clusters using AWS IAM and EKS Access Entries</p><p>Managing Kubernetes access with ConfigMap-based <code>aws-auth</code> entries is error-prone and hard to audit. Who has access? When was it granted? Long-lived kubeconfig tokens get shared across machines, and revoking access means editing a ConfigMap by hand.</p><p>EKS Access Entries provide a cleaner model: IAM principals map directly to Kubernetes permissions, and every authentication event is recorded in CloudTrail. Combined with Vouch, every <code>kubectl</code> command traces back to a hardware-verified human identity &ndash; no static tokens, no shared kubeconfigs.</p><h2 id=how-it-works>How it works</h2><p>The authentication flow chains four components:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>vouch login --&gt; vouch credential aws --&gt; aws eks get-token --&gt; kubectl
</span></span></code></pre></div><ol><li><strong><code>vouch login</code></strong> &ndash; The developer authenticates with their YubiKey and receives an OIDC ID token from the Vouch server.</li><li><strong><code>vouch credential aws</code></strong> &ndash; The CLI exchanges the OIDC token for temporary AWS STS credentials by calling <code>AssumeRoleWithWebIdentity</code>.</li><li><strong><code>aws eks get-token</code></strong> &ndash; The AWS CLI (or SDK) uses the STS credentials to generate a short-lived Kubernetes authentication token for the target EKS cluster.</li><li><strong><code>kubectl</code></strong> &ndash; The Kubernetes client sends the token to the EKS API server, which validates it against IAM and applies the permissions defined by Access Entries or RBAC.</li></ol><p>Because every step uses short-lived credentials, there are no static kubeconfig tokens or long-lived AWS keys to manage.</p><hr><h2 id=prerequisites>Prerequisites</h2><p>Before setting up EKS authentication with Vouch, ensure you have:</p><ul><li><strong>Vouch CLI installed and enrolled</strong> &ndash; Complete the <a href=/docs/getting-started/>Getting Started</a> guide.</li><li><strong>AWS integration configured</strong> &ndash; Complete the <a href=/docs/aws/>AWS Integration</a> guide. You need a working <code>vouch credential aws</code> setup with an IAM role.</li><li><strong>AWS CLI v2</strong> installed (<code>aws --version</code>).</li><li><strong>kubectl</strong> installed (<code>kubectl version --client</code>).</li><li><strong>An EKS cluster</strong> with the API server authentication mode set to include <code>API</code> (either <code>API</code> or <code>API_AND_CONFIG_MAP</code>). Clusters created with the default <code>CONFIG_MAP</code> mode must be updated.</li></ul><blockquote><p>See <a href=https://docs.aws.amazon.com/eks/latest/userguide/cluster-auth.html>EKS cluster authentication modes</a> for details on switching to API mode, and <a href=https://docs.aws.amazon.com/eks/latest/userguide/access-entries.html>EKS Access Entries</a> for the Access Entries feature.</p></blockquote><hr><h2 id=setup>Setup</h2><p>Configure <code>kubectl</code> to use your Vouch-backed AWS credentials for cluster authentication:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws eks update-kubeconfig <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name YOUR_CLUSTER_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --region YOUR_REGION <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --profile vouch
</span></span></code></pre></div><p>This writes or updates <code>~/.kube/config</code> with an <code>exec</code>-based user entry that calls <code>aws eks get-token</code>. Since the <code>vouch</code> AWS profile is configured with <code>credential_process</code>, the full chain from YubiKey to Kubernetes is automatic.</p><h3 id=verify-the-kubeconfig>Verify the kubeconfig</h3><p>Check that the context is set correctly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config current-context
</span></span></code></pre></div><p>The output should include the cluster name and region.</p><hr><h2 id=usage>Usage</h2><p>With everything configured, daily usage is straightforward:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Start your day</span>
</span></span><span style=display:flex><span>vouch login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use kubectl as normal</span>
</span></span><span style=display:flex><span>kubectl get pods
</span></span><span style=display:flex><span>kubectl get namespaces
</span></span><span style=display:flex><span>kubectl logs deployment/my-app
</span></span></code></pre></div><p>All authentication happens transparently. If your session expires (after 8 hours), run <code>vouch login</code> again.</p><hr><h2 id=creating-eks-access-entries>Creating EKS Access Entries</h2><p>EKS Access Entries map IAM principals (users or roles) to Kubernetes permissions. An administrator must create an Access Entry for the IAM role used by Vouch.</p><h3 id=aws-cli>AWS CLI</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create the Access Entry for the Vouch IAM role</span>
</span></span><span style=display:flex><span>aws eks create-access-entry <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --cluster-name YOUR_CLUSTER_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --principal-arn arn:aws:iam::123456789012:role/VouchDeveloper <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --type STANDARD
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Associate an access policy (e.g., cluster admin)</span>
</span></span><span style=display:flex><span>aws eks associate-access-policy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --cluster-name YOUR_CLUSTER_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --principal-arn arn:aws:iam::123456789012:role/VouchDeveloper <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --access-scope <span style=color:#e6db74>&#39;{&#34;type&#34;: &#34;cluster&#34;}&#39;</span>
</span></span></code></pre></div><p>To restrict access to specific namespaces:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws eks associate-access-policy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --cluster-name YOUR_CLUSTER_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --principal-arn arn:aws:iam::123456789012:role/VouchDeveloper <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSEditPolicy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --access-scope <span style=color:#e6db74>&#39;{&#34;type&#34;: &#34;namespace&#34;, &#34;namespaces&#34;: [&#34;default&#34;, &#34;staging&#34;]}&#39;</span>
</span></span></code></pre></div><h3 id=terraform>Terraform</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_eks_access_entry&#34; &#34;vouch_developer&#34;</span> {
</span></span><span style=display:flex><span>  cluster_name  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_eks_cluster</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  principal_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_iam_role</span>.<span style=color:#66d9ef>vouch_developer</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  type          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;STANDARD&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_eks_access_policy_association&#34; &#34;vouch_developer_admin&#34;</span> {
</span></span><span style=display:flex><span>  cluster_name  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_eks_cluster</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  principal_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_iam_role</span>.<span style=color:#66d9ef>vouch_developer</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  policy_arn    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>access_scope</span> {
</span></span><span style=display:flex><span>    type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;cluster&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>For namespace-scoped access:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_eks_access_policy_association&#34; &#34;vouch_developer_edit&#34;</span> {
</span></span><span style=display:flex><span>  cluster_name  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_eks_cluster</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  principal_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_iam_role</span>.<span style=color:#66d9ef>vouch_developer</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  policy_arn    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;arn:aws:eks::aws:cluster-access-policy/AmazonEKSEditPolicy&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>access_scope</span> {
</span></span><span style=display:flex><span>    type       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;namespace&#34;</span>
</span></span><span style=display:flex><span>    namespaces <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;default&#34;, &#34;staging&#34;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h2 id=available-access-policies>Available Access Policies</h2><p>EKS provides several built-in <a href=https://docs.aws.amazon.com/eks/latest/userguide/access-policies.html>access policies</a> that map to standard Kubernetes RBAC roles:</p><table><thead><tr><th>Access Policy ARN</th><th>Kubernetes Equivalent</th><th>Description</th></tr></thead><tbody><tr><td><code>arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy</code></td><td><code>cluster-admin</code></td><td>Full access to all resources in the cluster.</td></tr><tr><td><code>arn:aws:eks::aws:cluster-access-policy/AmazonEKSAdminPolicy</code></td><td><code>admin</code></td><td>Full access within namespaces, plus limited cluster-scoped access.</td></tr><tr><td><code>arn:aws:eks::aws:cluster-access-policy/AmazonEKSEditPolicy</code></td><td><code>edit</code></td><td>Read/write access to most resources in a namespace (no role or role-binding changes).</td></tr><tr><td><code>arn:aws:eks::aws:cluster-access-policy/AmazonEKSViewPolicy</code></td><td><code>view</code></td><td>Read-only access to most resources in a namespace.</td></tr><tr><td><code>arn:aws:eks::aws:cluster-access-policy/AmazonEKSAdminViewPolicy</code></td><td>N/A</td><td>Read-only access to all resources in the cluster, including secrets.</td></tr></tbody></table><p>When associating a policy, choose the appropriate <strong>access scope</strong>:</p><ul><li><strong><code>cluster</code></strong> &ndash; The policy applies across all namespaces.</li><li><strong><code>namespace</code></strong> &ndash; The policy applies only to the specified namespaces.</li></ul><p>Cluster-scoped policies (like <code>AmazonEKSClusterAdminPolicy</code>) must use <code>type: cluster</code>. Namespace-scoped policies (like <code>AmazonEKSEditPolicy</code>) can use either scope type.</p><hr><h2 id=custom-rbac>Custom RBAC</h2><p>If the built-in access policies do not fit your needs, you can use standard Kubernetes RBAC instead. Create the Access Entry with type <code>STANDARD</code> and do not associate any EKS access policies. Then create Kubernetes <code>ClusterRoleBinding</code> or <code>RoleBinding</code> resources that reference the IAM role&rsquo;s assumed-role ARN.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterRoleBinding</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>vouch-developer-custom</span>
</span></span><span style=display:flex><span><span style=color:#f92672>subjects</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Group</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;arn:aws:iam::123456789012:role/VouchDeveloper&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>apiGroup</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io</span>
</span></span><span style=display:flex><span><span style=color:#f92672>roleRef</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterRole</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>your-custom-role</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>apiGroup</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io</span>
</span></span></code></pre></div><p>For per-user permissions using session tags from Vouch, you can create separate IAM roles per team or per access level and map each to different Kubernetes roles.</p><hr><h2 id=troubleshooting>Troubleshooting</h2><h3 id=error-you-must-be-logged-in-to-the-server-unauthorized>&ldquo;error: You must be logged in to the server (Unauthorized)&rdquo;</h3><ul><li>Confirm you have an active Vouch session: <code>vouch status</code>.</li><li>Verify AWS credentials are working: <code>aws sts get-caller-identity --profile vouch</code>.</li><li>Check that an EKS Access Entry exists for your IAM role: <code>aws eks list-access-entries --cluster-name YOUR_CLUSTER_NAME</code>.</li><li>Ensure the cluster&rsquo;s authentication mode includes <code>API</code>. Check with: <code>aws eks describe-cluster --name YOUR_CLUSTER_NAME --query "cluster.accessConfig.authenticationMode"</code>.</li></ul><h3 id=error-exec-plugin-is-configured-to-use-api-version-clientauthenticationk8siov1alpha1>&ldquo;error: exec plugin is configured to use API version client.authentication.k8s.io/v1alpha1&rdquo;</h3><ul><li>Update your kubeconfig by re-running <code>aws eks update-kubeconfig</code>. Older versions of the AWS CLI may generate kubeconfig entries using a deprecated API version.</li><li>Ensure you are running AWS CLI v2.</li></ul><h3 id=credentials-expire-during-long-operations>Credentials expire during long operations</h3><ul><li>STS credentials obtained through Vouch last up to 1 hour. For long-running operations such as Helm deployments or large-scale rollouts, run <code>vouch login</code> beforehand to ensure a fresh 8-hour session.</li><li>If a command fails mid-operation, run <code>vouch login</code> and retry. The kubeconfig exec plugin will automatically pick up the new credentials.</li></ul><h3 id=accessdeniedexception-when-calling-eks-apis>&ldquo;AccessDeniedException&rdquo; when calling EKS APIs</h3><ul><li>The IAM role assumed by Vouch needs <code>eks:DescribeCluster</code> permission (at minimum) to run <code>aws eks update-kubeconfig</code>.</li><li>For Access Entry management, the administrator&rsquo;s IAM role needs <code>eks:CreateAccessEntry</code>, <code>eks:AssociateAccessPolicy</code>, and related permissions.</li></ul><h3 id=cannot-see-resources-in-a-specific-namespace>Cannot see resources in a specific namespace</h3><ul><li>Check the access scope of the associated access policy. If the policy is scoped to specific namespaces, you can only access resources in those namespaces.</li><li>Verify with: <code>aws eks list-associated-access-policies --cluster-name YOUR_CLUSTER_NAME --principal-arn YOUR_ROLE_ARN</code>.</li></ul><h3 id=kubectl-works-but-helm-does-not>kubectl works but Helm does not</h3><ul><li>Helm may require additional permissions beyond what <code>view</code> or <code>edit</code> policies provide (e.g., creating <code>ServiceAccount</code>, <code>Role</code>, or <code>RoleBinding</code> resources). Consider using <code>AmazonEKSAdminPolicy</code> or a custom RBAC role that grants the necessary permissions.</li></ul></article></div><div class=sidebar-overlay id=sidebar-overlay onclick=closeSidebar()></div><button class=sidebar-toggle onclick=toggleSidebar() aria-label="Toggle sidebar">
<svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</button>
<script>function toggleSidebar(){document.getElementById("docs-sidebar").classList.toggle("open"),document.getElementById("sidebar-overlay").classList.toggle("open")}function closeSidebar(){document.getElementById("docs-sidebar").classList.remove("open"),document.getElementById("sidebar-overlay").classList.remove("open")}</script></main><footer class=footer><div class=footer-inner><div class=footer-left><div>&copy; 2026 Smoke Turner, LLC</div><div class=footer-instances>Instances:
<a href=https://us.vouch.sh>US</a>
&#183;
<span class=coming-soon>EU (coming soon)</span>
&#183;
<span class=coming-soon>APAC (coming soon)</span></div></div><div class=footer-links><a href=/about/>About</a>
<a href=/docs/security/>Security</a>
<a href=/privacy/>Privacy</a>
<a href=/terms/>Terms</a>
<a href=https://github.com/vouch-sh/vouch target=_blank rel=noopener>GitHub</a></div></div></footer></body></html>