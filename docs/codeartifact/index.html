<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Authenticate to AWS CodeArtifact without Stored Tokens â€” Vouch â€” Hardware-Backed Developer Credentials</title>
<meta name=description content="Pull and publish packages from AWS CodeArtifact using hardware-backed credentials â€” no token files, no refresh scripts."><link rel=canonical href=https://vouch.sh/docs/codeartifact/><meta property="og:title" content="Authenticate to AWS CodeArtifact without Stored Tokens â€” Vouch â€” Hardware-Backed Developer Credentials"><meta property="og:description" content="Pull and publish packages from AWS CodeArtifact using hardware-backed credentials â€” no token files, no refresh scripts."><meta property="og:url" content="https://vouch.sh/docs/codeartifact/"><meta property="og:site_name" content="Vouch"><meta property="og:type" content="article"><meta property="og:image" content="https://vouch.sh/img/og-image.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Authenticate to AWS CodeArtifact without Stored Tokens â€” Vouch â€” Hardware-Backed Developer Credentials"><meta name=twitter:description content="Pull and publish packages from AWS CodeArtifact using hardware-backed credentials â€” no token files, no refresh scripts."><meta name=twitter:image content="https://vouch.sh/img/og-image.png"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"><link rel=icon href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ”‘</text></svg>"><link rel=author href=/humans.txt><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","description":"Open-source credential broker that issues short-lived SSH, AWS, GitHub, and Kubernetes credentials after FIDO2 hardware verification. One YubiKey tap, 8 hours of access.","name":"Vouch","url":"https://vouch.sh/"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","logo":"https://vouch.sh/img/og-image.png","name":"Smoke Turner, LLC","sameAs":["https://github.com/vouch-sh/vouch"],"url":"https://smoketurner.com"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"TechArticle","author":{"@type":"Organization","name":"Smoke Turner, LLC"},"description":"Pull and publish packages from AWS CodeArtifact using hardware-backed credentials â€” no token files, no refresh scripts.","headline":"Authenticate to AWS CodeArtifact without Stored Tokens","mainEntityOfPage":{"@id":"https://vouch.sh/docs/codeartifact/","@type":"WebPage"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://vouch.sh/img/og-image.png"},"name":"Smoke Turner, LLC"}}</script><link rel=stylesheet href=https://vouch.sh/css/main.min.696319dec26a9f9526ac8dae8c8e12c4271af4250b998632e1aca67447bb363d.css></head><body><header class=nav><div class=nav-inner><a href=/ class=nav-logo><svg viewBox="0 0 32 32" fill="none"><rect x="9" y="14" width="14" height="12" rx="2" stroke="currentcolor" stroke-width="2"/><path d="M12 14V10a4 4 0 118 0v4" stroke="currentcolor" stroke-width="2" stroke-linecap="round"/><circle cx="16" cy="20" r="1.5" fill="currentcolor"/><line x1="16" y1="21.5" x2="16" y2="23.5" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"/></svg>
vouch
</a><button class=nav-toggle aria-label="Toggle navigation" onclick='document.querySelector(".nav-links").classList.toggle("open")'><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class=nav-links><li><a href=/docs/>Docs</a></li><li><a href=/blog/>Blog</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/vouch-sh/vouch target=_blank rel=noopener>GitHub<svg class="github-icon" viewBox="0 0 24 24" fill="currentcolor"><path d="M12 0C5.37.0.0 5.37.0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57.0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925.0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18.0.0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225.0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22.0 1.605-.015 2.895-.015 3.3.0.315.225.69.825.57A12.02 12.02.0 0024 12c0-6.63-5.37-12-12-12z"/></svg></a></li></ul></div></header><main class=content-wrapper><div class=docs-layout><aside class=docs-sidebar id=docs-sidebar><div class=docs-sidebar-title>Documentation</div><nav><ul><li><a href=https://vouch.sh/docs/getting-started/>Getting Started</a></li><li><a href=https://vouch.sh/docs/startups/>Startups</a></li><li class=sidebar-section-group><span class=sidebar-section-label>Infrastructure</span><ul><li><a href=https://vouch.sh/docs/aws/>AWS</a></li><li><a href=https://vouch.sh/docs/aws-multi-account/>AWS Multi-Account</a></li><li><a href=https://vouch.sh/docs/ssh/>SSH Certificates</a></li><li><a href=https://vouch.sh/docs/eks/>Amazon EKS</a></li><li><a href=https://vouch.sh/docs/ssm/>AWS Systems Manager</a></li><li><a href=https://vouch.sh/docs/databases/>Databases</a></li><li><a href=https://vouch.sh/docs/bedrock/>Amazon Bedrock</a></li></ul></li><li class=sidebar-section-group><span class=sidebar-section-label>Code & Packages</span><ul><li><a href=https://vouch.sh/docs/github/>GitHub</a></li><li><a href=https://vouch.sh/docs/docker/>Docker Registries</a></li><li><a href=https://vouch.sh/docs/codeartifact/ class=active>AWS CodeArtifact</a></li><li><a href=https://vouch.sh/docs/codecommit/>AWS CodeCommit</a></li><li><a href=https://vouch.sh/docs/cargo/>Cargo</a></li></ul></li><li class=sidebar-section-group><span class=sidebar-section-label>Platform</span><ul><li class=sidebar-group><div class=sidebar-group-header><a href=https://vouch.sh/docs/applications/>Applications (OIDC)
</a><button class=sidebar-chevron onclick='this.closest(".sidebar-group").classList.toggle("open")' aria-label="Toggle section"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg></button></div><ul class=sidebar-children><li><a href=https://vouch.sh/docs/applications/rails/>Rails (OmniAuth)</a></li><li><a href=https://vouch.sh/docs/applications/django/>Django (django-allauth)</a></li><li><a href=https://vouch.sh/docs/applications/express/>Express.js (Passport)</a></li><li><a href=https://vouch.sh/docs/applications/nextjs/>Next.js (NextAuth.js)</a></li><li><a href=https://vouch.sh/docs/applications/laravel/>Laravel (Socialite)</a></li><li><a href=https://vouch.sh/docs/applications/flask/>Flask (Authlib)</a></li><li><a href=https://vouch.sh/docs/applications/fastapi/>FastAPI (Authlib)</a></li><li><a href=https://vouch.sh/docs/applications/spring-boot/>Spring Boot (Spring Security)</a></li><li><a href=https://vouch.sh/docs/applications/axum/>Axum (openidconnect-rs)</a></li><li><a href=https://vouch.sh/docs/applications/react/>React (react-oidc-context)</a></li><li><a href=https://vouch.sh/docs/applications/vue/>Vue (oidc-client-ts)</a></li><li><a href=https://vouch.sh/docs/applications/vanilla-js/>Vanilla JavaScript</a></li><li><a href=https://vouch.sh/docs/applications/device-authorization/>Device Authorization (CLI)</a></li></ul></li><li><a href=https://vouch.sh/docs/scim/>SCIM Provisioning</a></li><li><a href=https://vouch.sh/docs/iac/>Infrastructure as Code</a></li><li><a href=https://vouch.sh/docs/cicd/>CI/CD</a></li><li><a href=https://vouch.sh/docs/cli-reference/>CLI Reference</a></li><li><a href=https://vouch.sh/docs/security/>Security</a></li><li><a href=https://vouch.sh/docs/threat-model/>Threat Model</a></li><li><a href=https://vouch.sh/docs/architecture/>Architecture</a></li><li><a href=https://vouch.sh/docs/availability/>Availability</a></li><li><a href=https://vouch.sh/docs/migration/>Migration</a></li><li><a href=https://vouch.sh/docs/faq/>FAQ</a></li></ul></li></ul></nav></aside><article class=docs-content><div class=docs-breadcrumb><a href=https://vouch.sh/docs/>Docs</a><span class=separator>/</span>
Authenticate to AWS CodeArtifact without Stored Tokens</div><h1>Authenticate to AWS CodeArtifact without Stored Tokens</h1><p style=color:var(--text-muted);font-size:1.1rem;margin-bottom:2rem>Authenticate to AWS CodeArtifact repositories using Vouch</p><p>Every package manager has its own credential mechanism &ndash; pip uses <code>~/.pip/pip.conf</code> or <code>PIP_INDEX_URL</code>, npm uses <code>.npmrc</code>, Cargo uses <code>~/.cargo/credentials.toml</code>, and Maven uses <code>settings.xml</code>. Each requires a different token format and rotation process. Keeping them all current across a growing team is a constant chore.</p><p>With <a href=https://docs.aws.amazon.com/codeartifact/latest/ug/welcome.html>AWS CodeArtifact</a>, you can unify these behind IAM, and with Vouch, the IAM credentials are hardware-backed and automatic. After a single <code>vouch login</code>, package managers like Cargo, pip, and npm can pull and publish packages from your AWS CodeArtifact repositories without manual token management.</p><h2 id=how-it-works>How it works</h2><ol><li><strong>Package manager requests a token</strong> &ndash; When a package manager needs to authenticate to an AWS CodeArtifact repository, the Vouch credential helper intercepts the request.</li><li><strong>OIDC to STS</strong> &ndash; Vouch exchanges your active hardware-backed session for temporary AWS STS credentials via <code>AssumeRoleWithWebIdentity</code>.</li><li><strong>STS to AWS CodeArtifact</strong> &ndash; Vouch calls <code>codeartifact:GetAuthorizationToken</code> with the STS credentials to obtain an AWS CodeArtifact authorization token.</li><li><strong>Package manager authenticates</strong> &ndash; The token is returned to the package manager and used for the current operation. Tokens are short-lived and never written to disk.</li></ol><hr><h2 id=prerequisites>Prerequisites</h2><p>Before configuring the AWS CodeArtifact integration, make sure you have:</p><ul><li>The <strong>Vouch CLI</strong> installed and enrolled (see <a href=/docs/getting-started/>Getting Started</a>)</li><li>The <strong><a href=/docs/aws/>AWS integration</a></strong> configured (OIDC provider and IAM role)</li><li>An <strong>AWS CodeArtifact domain and repository</strong> in your AWS account</li><li>The IAM role must have <code>codeartifact:GetAuthorizationToken</code> and <code>sts:GetServiceBearerToken</code> permissions</li></ul><hr><h2 id=step-1----configure-the-vouch-cli>Step 1 &ndash; Configure the Vouch CLI</h2><p>Run the setup command to configure Vouch for your AWS CodeArtifact repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vouch setup codeartifact --tool cargo --repository my-repo <span style=color:#f92672>[</span>--domain my-domain<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--domain-owner 123456789012<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--region us-east-1<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--profile my-profile<span style=color:#f92672>]</span>
</span></span></code></pre></div><table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--tool</code></td><td>Package manager to configure: <code>cargo</code>, <code>pip</code>, or <code>npm</code> (required)</td></tr><tr><td><code>--repository</code></td><td>The AWS CodeArtifact repository name (required)</td></tr><tr><td><code>--domain</code></td><td>The AWS CodeArtifact domain name (optional if a profile is configured)</td></tr><tr><td><code>--domain-owner</code></td><td>AWS account ID that owns the domain (optional if a profile is configured)</td></tr><tr><td><code>--region</code></td><td>AWS region (default: <code>us-east-1</code>; optional if a profile is configured)</td></tr><tr><td><code>--profile</code></td><td>Named profile to use or create (see <a href=#profiles>Profiles</a> below)</td></tr></tbody></table><p>This configures the appropriate credential helper for your package manager and writes the necessary configuration files.</p><hr><h2 id=profiles>Profiles</h2><p>Vouch supports named profiles for AWS CodeArtifact, allowing you to store domain, domain owner, and region settings and reuse them across commands. Profiles are stored in <code>~/.vouch/config.json</code>.</p><h3 id=default-profile>Default profile</h3><p>When you run <code>vouch setup codeartifact</code> with <code>--domain</code>, <code>--domain-owner</code>, and <code>--region</code>, these values are saved to the default profile. Subsequent commands can omit these flags:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># First time: specify all values (saved to default profile)</span>
</span></span><span style=display:flex><span>vouch setup codeartifact --tool cargo --domain my-domain --domain-owner <span style=color:#ae81ff>123456789012</span> --repository my-repo --region us-east-1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Later: only --tool and --repository are needed</span>
</span></span><span style=display:flex><span>vouch setup codeartifact --tool pip --repository my-pypi-repo
</span></span></code></pre></div><h3 id=named-profiles>Named profiles</h3><p>Use <code>--profile</code> to create and manage separate configurations for different AWS CodeArtifact domains or accounts:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create a profile for the shared artifacts account</span>
</span></span><span style=display:flex><span>vouch setup codeartifact --tool cargo --domain shared-packages --domain-owner <span style=color:#ae81ff>111111111111</span> --repository cargo-store --profile shared
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a profile for the team account</span>
</span></span><span style=display:flex><span>vouch setup codeartifact --tool cargo --domain team-packages --domain-owner <span style=color:#ae81ff>222222222222</span> --repository team-cargo --profile team
</span></span></code></pre></div><p>Named profiles are referenced by other commands using the <code>--profile</code> flag.</p><hr><h2 id=supported-package-managers>Supported package managers</h2><table><thead><tr><th>Package Manager</th><th>Protocol</th><th>Authentication Method</th><th>Token Model</th></tr></thead><tbody><tr><td><strong>Cargo</strong></td><td><code>sparse+https</code></td><td>Bearer token via credential provider</td><td>Dynamic (fetched on demand)</td></tr><tr><td><strong>pip</strong></td><td>HTTPS</td><td>Token embedded in index URL</td><td>Dynamic (fetched on demand)</td></tr><tr><td><strong>npm</strong></td><td>HTTPS</td><td>Bearer token via <code>.npmrc</code></td><td>Static (embedded in <code>.npmrc</code>, ~12h expiry)</td></tr></tbody></table><p><strong>Dynamic tokens</strong> (Cargo, pip) are fetched transparently on each operation and do not expire during normal use. <strong>Static tokens</strong> (npm) are written to <code>.npmrc</code> during setup and expire after approximately 12 hours. When an npm token expires, re-run <code>vouch setup codeartifact --tool npm --repository &lt;REPO></code> to refresh it.</p><hr><h2 id=step-2----authenticate>Step 2 &ndash; Authenticate</h2><p>If you have not already logged in today, authenticate with your YubiKey:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>vouch login
</span></span></code></pre></div><p>Your session lasts for 8 hours. All AWS CodeArtifact operations during that window use the session automatically.</p><hr><h2 id=step-3----use-your-package-manager-normally>Step 3 &ndash; Use your package manager normally</h2><h3 id=cargo>Cargo</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Build a project that depends on private crates</span>
</span></span><span style=display:flex><span>cargo build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish a crate to your AWS CodeArtifact registry</span>
</span></span><span style=display:flex><span>cargo publish --registry my-codeartifact-registry
</span></span></code></pre></div><p>Cargo tokens are fetched dynamically on each operation via the credential provider. No token refresh is needed.</p><h3 id=pip>pip</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install a package from your AWS CodeArtifact repository</span>
</span></span><span style=display:flex><span>pip install my-package --index-url https://my-domain-123456789012.d.codeartifact.us-east-1.amazonaws.com/pypi/my-repo/simple/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install from requirements.txt</span>
</span></span><span style=display:flex><span>pip install -r requirements.txt
</span></span></code></pre></div><p>pip tokens are fetched dynamically by embedding the credential helper in the index URL. No token refresh is needed.</p><h3 id=npm>npm</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install packages</span>
</span></span><span style=display:flex><span>npm install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish a package</span>
</span></span><span style=display:flex><span>npm publish
</span></span></code></pre></div><p>npm uses a static token written to <code>.npmrc</code>. If you see authentication errors after ~12 hours, re-run <code>vouch setup codeartifact --tool npm --repository &lt;REPO></code> to refresh the token.</p><hr><h2 id=environment-variables>Environment variables</h2><p>You can inject a <code>CODEARTIFACT_AUTH_TOKEN</code> environment variable into your shell or a subprocess using <code>vouch env</code> or <code>vouch exec</code>. This is useful for tools that read the token from the environment (such as Maven or custom scripts).</p><h3 id=vouch-env><code>vouch env</code></h3><p>Output the token as a shell export statement:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eval <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>vouch env --type codeartifact <span style=color:#f92672>[</span>--ca-domain &lt;DOMAIN&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-domain-owner &lt;ACCOUNT_ID&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-region &lt;REGION&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-profile &lt;PROFILE&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--shell &lt;SHELL&gt;<span style=color:#f92672>]</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>This sets <code>CODEARTIFACT_AUTH_TOKEN</code> in your current shell.</p><h3 id=vouch-exec><code>vouch exec</code></h3><p>Run a command with the token injected:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vouch exec --type codeartifact <span style=color:#f92672>[</span>--ca-domain &lt;DOMAIN&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-domain-owner &lt;ACCOUNT_ID&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-region &lt;REGION&gt;<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--ca-profile &lt;PROFILE&gt;<span style=color:#f92672>]</span> -- mvn deploy
</span></span></code></pre></div><table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td><code>--ca-domain</code></td><td>AWS CodeArtifact domain name (optional if a profile is configured)</td></tr><tr><td><code>--ca-domain-owner</code></td><td>AWS account ID that owns the domain (optional if a profile is configured)</td></tr><tr><td><code>--ca-region</code></td><td>AWS region (optional if a profile is configured)</td></tr><tr><td><code>--ca-profile</code></td><td>Named AWS CodeArtifact profile to use</td></tr></tbody></table><hr><h2 id=cross-partition-support>Cross-partition support</h2><p>Vouch supports AWS CodeArtifact across all AWS partitions:</p><table><thead><tr><th>Partition</th><th>Region Examples</th></tr></thead><tbody><tr><td><strong>Standard</strong> (<code>aws</code>)</td><td><code>us-east-1</code>, <code>eu-west-1</code>, <code>ap-southeast-1</code></td></tr><tr><td><strong>China</strong> (<code>aws-cn</code>)</td><td><code>cn-north-1</code>, <code>cn-northwest-1</code></td></tr><tr><td><strong>GovCloud</strong> (<code>aws-us-gov</code>)</td><td><code>us-gov-west-1</code>, <code>us-gov-east-1</code></td></tr></tbody></table><p>Use the <code>--region</code> flag during setup to configure the appropriate partition.</p><hr><h2 id=troubleshooting>Troubleshooting</h2><h3 id=access-denied-when-fetching-packages>&ldquo;Access denied&rdquo; when fetching packages</h3><ul><li>Verify your IAM role has the following permissions:<ul><li><code>codeartifact:GetAuthorizationToken</code></li><li><code>codeartifact:GetRepositoryEndpoint</code></li><li><code>codeartifact:ReadFromRepository</code></li><li><code>sts:GetServiceBearerToken</code></li></ul></li><li>Confirm the AWS CodeArtifact domain and repository names are correct.</li><li>Check that you have an active Vouch session: <code>vouch login</code>.</li></ul><h3 id=token-is-expired>&ldquo;Token is expired&rdquo;</h3><ul><li>For <strong>npm</strong>: Re-run <code>vouch setup codeartifact --tool npm --repository &lt;REPO></code> to refresh the static token in <code>.npmrc</code>.</li><li>For <strong>Cargo/pip</strong>: Run <code>vouch login</code> to refresh your session. Dynamic tokens are fetched on demand, so expiry usually indicates the Vouch session itself has ended.</li></ul><h3 id=wrong-domain-or-repository>Wrong domain or repository</h3><ul><li>Run <code>vouch setup codeartifact</code> again with the correct <code>--tool</code> and <code>--repository</code> flags.</li><li>If using profiles, check <code>~/.vouch/config.json</code> for the stored domain and region values.</li><li>Check your package manager&rsquo;s configuration files for conflicting settings.</li></ul><h3 id=package-manager-not-using-vouch>Package manager not using Vouch</h3><ul><li>Ensure no environment variables (e.g., <code>CODEARTIFACT_AUTH_TOKEN</code>) are overriding the credential helper.</li><li>Verify the package manager configuration points to the correct AWS CodeArtifact endpoint.</li></ul><hr><h2 id=maven>Maven</h2><p>For Maven projects, use <code>vouch credential codeartifact</code> or <code>vouch exec</code> to obtain a token:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Option 1: Set the token in your shell</span>
</span></span><span style=display:flex><span>export CODEARTIFACT_AUTH_TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>vouch credential codeartifact<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Option 2: Use vouch exec to inject the token into Maven</span>
</span></span><span style=display:flex><span>vouch exec --type codeartifact -- mvn deploy -s settings.xml
</span></span></code></pre></div><p>If you need to specify the domain explicitly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export CODEARTIFACT_AUTH_TOKEN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>vouch credential codeartifact --domain my-domain --domain-owner 123456789012<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>In your <code>settings.xml</code>, reference the environment variable as the password:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;server&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;id&gt;</span>codeartifact<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;username&gt;</span>aws<span style=color:#f92672>&lt;/username&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;password&gt;</span>${env.CODEARTIFACT_AUTH_TOKEN}<span style=color:#f92672>&lt;/password&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/server&gt;</span>
</span></span></code></pre></div><hr><h2 id=cross-account-access>Cross-Account Access</h2><p>If your AWS CodeArtifact domain is in a different AWS account, use named profiles to manage access:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Set up a Vouch AWS profile for the artifacts account</span>
</span></span><span style=display:flex><span>vouch setup aws <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --role arn:aws:iam::ARTIFACTS_ACCOUNT:role/CodeArtifactReader <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --profile vouch-artifacts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create an AWS CodeArtifact profile that uses the artifacts account</span>
</span></span><span style=display:flex><span>vouch setup codeartifact <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --tool npm <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --domain shared-packages <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --domain-owner ARTIFACTS_ACCOUNT <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --repository npm-store <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --profile artifacts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use the profile when fetching credentials</span>
</span></span><span style=display:flex><span>vouch credential codeartifact --profile artifacts
</span></span></code></pre></div><hr><h2 id=token-lifetime>Token Lifetime</h2><p>AWS CodeArtifact authorization tokens are valid for up to <strong>12 hours</strong> by default. For Cargo and pip, Vouch fetches tokens dynamically on each operation, so expiry is transparent. For npm, the token is embedded in <code>.npmrc</code> and must be refreshed by re-running <code>vouch setup codeartifact --tool npm</code> when it expires. If your Vouch session (8 hours) has expired, run <code>vouch login</code> first.</p></article></div><div class=sidebar-overlay id=sidebar-overlay onclick=closeSidebar()></div><button class=sidebar-toggle onclick=toggleSidebar() aria-label="Toggle sidebar">
<svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</button>
<script>function toggleSidebar(){document.getElementById("docs-sidebar").classList.toggle("open"),document.getElementById("sidebar-overlay").classList.toggle("open")}function closeSidebar(){document.getElementById("docs-sidebar").classList.remove("open"),document.getElementById("sidebar-overlay").classList.remove("open")}</script></main><footer class=footer><div class=footer-inner><div class=footer-left><div>&copy; 2026 Smoke Turner, LLC</div><div class=footer-instances>Instances:
<a href=https://us.vouch.sh>US</a>
&#183;
<span class=coming-soon>EU (coming soon)</span>
&#183;
<span class=coming-soon>APAC (coming soon)</span></div></div><div class=footer-links><a href=/about/>About</a>
<a href=/docs/security/>Security</a>
<a href=/privacy/>Privacy</a>
<a href=/terms/>Terms</a>
<a href=https://github.com/vouch-sh/vouch target=_blank rel=noopener>GitHub</a></div></div></footer></body></html>